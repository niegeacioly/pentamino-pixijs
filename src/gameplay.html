<!DOCTYPE html>
<html lang="pt-br">
    <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

      <!-- Bootstrap CSS -->
      <!-- integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" crossorigin="anonymous">
      <link rel="stylesheet" href="gameplay.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.5.1/pixi.min.js"></script>
      <script src="../bin/scaleToWindow.js"></script>
      <title>Game Play</title>
      </head>
      <body>
          <nav class="navbar navbar-light bg-faded">
            <a class="navbar-brand" href="#">
              <img src="images/logo_pentamino.png" class="img-fluid" width="200" height="auto" class="d-inline-block align-top" alt="PentaminÃ³">
            </a>
            <br>
            <span id="teste">0</span>
            <br>
            <span id="teste1">0</span>
          </nav>    

          <script type="text/javascript">

                //Aliases
                    var Container = PIXI.Container,
                        autoDetectRenderer = PIXI.autoDetectRenderer,
                        loader = PIXI.loader,
                        resources = PIXI.loader.resources,
                        Sprite = PIXI.Sprite;

                    var stage = new Container(), renderer = autoDetectRenderer(1200, 500, { antialias: true }, true);
                    renderer.view.style.border = "1px dashed black";
                    // renderer.backgroundColor = 0x232325;
                    renderer.backgroundColor = 0xFFFFFF;

                    var matrixGrid = new Array();

                    var minPixel = 3, defaultIndentation = 20;

                    document.body.appendChild(renderer.view);

                    loader
                        .add("images/grid.png")
                        // .add("images/blockp.png")
                        // .add("images/blockt.png")
                        // .add("images/blocki.png")
                        // .add("images/blockx.png")
                        // .add("images/blocku.png")
                        // .add("images/blockv.png")
                        // .add("images/blockl.png")
                        // .add("images/blockz.png")
                        // .add("images/blocky.png")
                        // .add("images/blockn.png")
                        .add("images/blockw.png")
                        .add("images/blockf.png")
                        .load(setupGrid)
                        // .load(setupLetterP)
                        // .load(setupLetterT)
                        // .load(setupLetterI)
                        // .load(setupLetterX)
                        // .load(setupLetterU)
                        // .load(setupLetterV)
                        // .load(setupLetterL)
                        // .load(setupLetterZ)
                        // .load(setupLetterY)
                        // .load(setupLetterN)
                        .load(setupLetterW)
                        .load(setupLetterF);

                    function setupGrid() {

                        //Create the grid
                        gridContainer = new Container();
                        resource = resources["images/grid.png"].texture;
                        var grid = new Sprite(resource);
                        gridContainer.addChild(grid);
                        stage.addChild(gridContainer);

                        for(var y = 1; y <= 6; y++){
                            for(var x = 1; x <= 8; x++){
                                var maxX = 0, minX = 0, maxY = 0, minY = 0;
                                maxX = (40 * x);
                                maxY = (40 * y);
                                minX = maxX - 40;
                                minY = maxY - 40;

                                matrixGrid.push({ minX: minX, minY: minY, maxX: maxX, maxY: maxY, centerX: minX + 20, centerY: minY + 20, check: false });
                            }
                        }

                        countCheckGrid();
                    }
                    
                    function setupLetterP() {

                        //Create the sprites
                        gameSceneP = new Container();
                        gameSceneP.interactive = true;
                        // gameSceneP.position.rotation = 0;
                        gameSceneP.x = 100;
                        gameSceneP.y = 100;
                        gameSceneP.rotation = 0;
                        // gameSceneP.pivot.x = 0.5;
                        // gameSceneP.pivot.y = 0.5;
                        gameSceneP.zIndex = 0;

                        resource = resources["images/blockp.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneP.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneP.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.height - minPixel;

                        gameSceneP.addChild(block3);
                        block3.position.y = block2.height - minPixel;
                        block3.position.x = 0;

                        gameSceneP.addChild(block4);
                        block4.position.y = block3.height - minPixel;
                        block4.position.x = block3.width - minPixel;

                        gameSceneP.addChild(block5);
                        block5.position.y = (block4.height - minPixel) + (block4.height - minPixel);
                        block5.position.x = 0;

                        // setup events
                        gameSceneP.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);
                        
                        stage.addChild(gameSceneP);

                        gameSceneP.pivot.set(gameSceneP.width/2, gameSceneP.height/2);
                        gameSceneP.updateTransform();

                    }

                    function setupLetterT() {

                        //Create the sprites
                        gameSceneT = new Container();
                        gameSceneT.interactive = true;
                        gameSceneT.position.rotation = 0;
                        gameSceneT.x = 100;
                        gameSceneT.y = defaultIndentation;
                        gameSceneT.rotation = 0;
                        // gameSceneT.pivot.x = 0.5;
                        // gameSceneT.pivot.y = 0.5;
                        gameSceneT.zIndex = 0;

                        resource = resources["images/blockt.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneT.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.height - minPixel;

                        gameSceneT.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneT.addChild(block3);
                        block3.position.y = (block1.height - minPixel) + (block2.height - minPixel);
                        block3.position.x = (block1.width - minPixel) + (block2.width - minPixel);

                        gameSceneT.addChild(block4);
                        block4.position.y = (block1.height - minPixel) + (block2.height - minPixel);
                        block4.position.x = (block1.height - minPixel);

                        gameSceneT.addChild(block5);
                        block5.position.y = (block1.height - minPixel) + (block1.height - minPixel);
                        block5.position.x = 0;

                        gameSceneT.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneT);
                        gameSceneT.pivot.set(gameSceneT.width/2, gameSceneT.height/2);
                        gameSceneT.updateTransform();
                    }
                    
                    function setupLetterI() {

                        //Create the sprites
                        gameSceneI = new Container();
                        gameSceneI.interactive = true;
                        gameSceneI.position.rotation = 0;
                        gameSceneI.x = 150;
                        gameSceneI.y = defaultIndentation;
                        gameSceneI.rotation = 0;
                        // gameSceneI.pivot.x = 0.5;
                        // gameSceneI.pivot.y = 0.5;
                        //gameSceneI.position.set(150, 200);
                        gameSceneI.zIndex = 0;

                        resource = resources["images/blocki.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneI.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneI.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneI.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneI.addChild(block4);
                        block4.position.y = 0;
                        block4.position.x = block1.width + block2.width + block3.width - (minPixel * 3);

                        gameSceneI.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width + block3.width + block4.width - (minPixel * 4);

                        gameSceneI.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneI);
                        gameSceneI.pivot.set(gameSceneI.width/2, gameSceneI.height/2);
                        gameSceneI.updateTransform();
                    }

                    function setupLetterX() {

                        //Create the sprites
                        gameSceneX = new Container();
                        gameSceneX.interactive = true;
                        gameSceneX.position.rotation = 0;
                        gameSceneX.x = 200;
                        gameSceneX.y = defaultIndentation;
                        gameSceneX.rotation = 0;
                        // gameSceneX.pivot.x = 0.5;
                        // gameSceneX.pivot.y = 0.5;
                        gameSceneX.zIndex = 0;

                        resource = resources["images/blockx.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneX.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.width - minPixel;

                        gameSceneX.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0;

                        gameSceneX.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneX.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneX.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width - minPixel;

                        gameSceneX.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove);

                        stage.addChild(gameSceneX);
                        gameSceneX.pivot.set(gameSceneX.width/2, gameSceneX.height/2);
                        gameSceneX.updateTransform();
                    }

                    function setupLetterU() {

                        //Create the sprites
                        gameSceneU = new Container();
                        gameSceneU.interactive = true;
                        gameSceneU.position.rotation = 0;
                        gameSceneU.x = 250;
                        gameSceneU.y = defaultIndentation;
                        gameSceneU.rotation = 0;
                        // gameSceneU.pivot.x = 0.5;
                        // gameSceneU.pivot.y = 0.5;
                        gameSceneU.zIndex = 0;

                        resource = resources["images/blocku.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneU.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneU.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0 ;

                        gameSceneU.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneU.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneU.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneU.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneU);
                        gameSceneU.pivot.set(gameSceneU.width/2, gameSceneU.height/2);
                        gameSceneU.updateTransform();
                    }

                    function setupLetterV() {

                        //Create the sprites
                        gameSceneV = new Container();
                        gameSceneV.interactive = true;
                        gameSceneV.position.rotation = 0;
                        gameSceneV.x = 280;
                        gameSceneV.y = defaultIndentation;
                        gameSceneV.rotation = 0;
                        // gameSceneV.pivot.x = 0.5;
                        // gameSceneV.pivot.y = 0.5;
                        gameSceneV.zIndex = 0;

                        resource = resources["images/blockv.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneV.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneV.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0 ;

                        gameSceneV.addChild(block3);
                        block3.position.y = block1.height + block2.height - (minPixel * 2);
                        block3.position.x = 0;

                        gameSceneV.addChild(block4);
                        block4.position.y = 0;
                        block4.position.x = block1.width - minPixel;

                        gameSceneV.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneV.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneV);
                        gameSceneV.pivot.set(gameSceneV.width/2, gameSceneV.height/2);
                        gameSceneV.updateTransform();
                    }

                    function setupLetterL() {

                        //Create the sprites
                        gameSceneL = new Container();
                        gameSceneL.interactive = true;
                        gameSceneL.position.rotation = 0;
                        gameSceneL.x = defaultIndentation;
                        gameSceneL.y = 150;
                        gameSceneL.rotation = 0;
                        // gameSceneL.pivot.x = 0.5;
                        // gameSceneL.pivot.y = 0.5;
                        gameSceneL.zIndex = 0;

                        resource = resources["images/blockl.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneL.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneL.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block4);
                        block4.position.y = block1.height + block2.height - (minPixel * 2);
                        block4.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block5);
                        block5.position.y = block1.height + block2.height + block3.height - (minPixel * 3);
                        block5.position.x = block1.width - minPixel;

                        gameSceneL.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneL);
                        gameSceneL.pivot.set(gameSceneL.width/2, gameSceneL.height/2);
                        gameSceneL.updateTransform();
                    }

                    function setupLetterZ() {

                        //Create the sprites
                        gameSceneZ = new Container();
                        gameSceneZ.interactive = true;
                        gameSceneZ.position.rotation = 0;
                        gameSceneZ.x = 60;
                        gameSceneZ.y = 150;
                        gameSceneZ.rotation = 0;
                        // gameSceneZ.pivot.x = 0.5;
                        // gameSceneZ.pivot.y = 0.5;
                        gameSceneZ.zIndex = 0;

                        resource = resources["images/blockz.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneZ.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneZ.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0;

                        gameSceneZ.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneZ.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2 );

                        gameSceneZ.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2 );
                        block5.position.x = block1.width + block2.width - (minPixel * 2 );

                        gameSceneZ.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneZ);
                        gameSceneZ.pivot.set(gameSceneZ.width/2, gameSceneZ.height/2);
                        gameSceneZ.updateTransform();
                    }

                    function setupLetterY() {

                        //Create the sprites
                        gameSceneY = new Container();
                        gameSceneY.interactive = true;
                        gameSceneY.position.rotation = 0;
                        gameSceneY.x = 60;
                        gameSceneY.y = 150;
                        gameSceneY.rotation = 0;
                        // gameSceneY.pivot.x = 0.5;
                        // gameSceneY.pivot.y = 0.5;
                        gameSceneY.zIndex = 0;

                        resource = resources["images/blocky.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneY.addChild(block1);
                        block1.position.y = block1.height - minPixel;
                        block1.position.x = 0;

                        gameSceneY.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneY.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width - minPixel;

                        gameSceneY.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneY.addChild(block5);
                        block5.position.y = block1.height - minPixel;
                        block5.position.x = block1.width + block2.width + block3.width - (minPixel * 3);

                        gameSceneY.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneY);
                        gameSceneY.pivot.set(gameSceneY.width/2, gameSceneY.height/2);
                        gameSceneY.updateTransform();
                    }

                    function setupLetterN() {

                        //Create the sprites
                        gameSceneN = new Container();
                        gameSceneN.interactive = true;
                        gameSceneN.position.rotation = 0;
                        gameSceneN.x = 60;
                        gameSceneN.y = 260;
                        gameSceneN.rotation = 0;
                        // gameSceneN.pivot.x = 0.5;
                        // gameSceneN.pivot.y = 0.5;
                        gameSceneN.zIndex = 0;

                        resource = resources["images/blockn.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneN.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block3);
                        block3.position.y = block1.height + block2.height - (minPixel * 2);
                        block3.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block4);
                        block4.position.y = block1.height + block2.height - (minPixel * 2);
                        block4.position.x = 0;

                        gameSceneN.addChild(block5);
                        block5.position.y = block1.height + block2.height + block3.height - (minPixel * 3);
                        block5.position.x = 0;

                        gameSceneN.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneN);
                        gameSceneN.pivot.set(gameSceneN.width/2, gameSceneN.height/2);
                        gameSceneN.updateTransform();
                    }

                    function setupLetterW() {

                        //Create the sprites
                        gameSceneW = new Container();
                        gameSceneW.interactive = true;
                        gameSceneW.position.rotation = 0;
                        gameSceneW.x = 150;
                        gameSceneW.y = 300;
                        gameSceneW.rotation = 0;
                        // gameSceneW.pivot.x = 0.5;
                        // gameSceneW.pivot.y = 0.5;
                        gameSceneW.zIndex = 0;

                        resource = resources["images/blockw.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneW.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneW.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneW.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneW.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneW.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneW.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick)
                            ;

                        stage.addChild(gameSceneW);
                        gameSceneW.pivot.set(gameSceneW.width/2, gameSceneW.height/2);
                        gameSceneW.updateTransform();
                    }

                    function setupLetterF() {

                        //Create the sprites
                        gameSceneF = new Container();
                        gameSceneF.interactive = true;
                        gameSceneF.position.rotation = 0;
                        gameSceneF.x = 300;
                        gameSceneF.y = 300;
                        gameSceneF.rotation = 0;
                        // gameSceneF.pivot.x = 0.5;
                        // gameSceneF.pivot.y = 0.5;
                        gameSceneF.zIndex = 0;

                        resource = resources["images/blockf.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneF.addChild(block1);
                        block1.position.y = block1.height - minPixel;
                        block1.position.x = 0;

                        gameSceneF.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneF.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width - minPixel;

                        gameSceneF.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneF.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneF.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick)
                            ;
                        console.log("w -> "+gameSceneF.width + " | h -> "+gameSceneF.height);
                        gameSceneF.pivot.set(gameSceneF.width/2, gameSceneF.height/2);
                        stage.addChild(gameSceneF);
                        
                        
                        gameSceneF.updateTransform();
                    }

                    function onDragStart(event) {
                        // store a reference to the data the reason for this is because of multitouch we want to track the movement of this particular touch
                        this.start_data = {x: event.data.originalEvent.screenX, y: event.data.originalEvent.screenY};
                        this.data = event.data;
                        this.alpha = 0.5;
                        this.dragging = true;
                        this.zIndex = 999;

                        event.currentTarget.calculateBounds();
                        unCheck(event.currentTarget.children);
                        
                    }   

                    function onDragEnd(event) {

                        var ev_data = event.data.originalEvent;

                        this.alpha = 1;

                        this.dragging = false;

                        if (this.start_data) {
                            if (Math.abs(this.start_data.x - ev_data.screenX) > 2 || Math.abs(this.start_data.y - ev_data.screenY) > 2) {
                                event.stopPropagation();
                            }
                        }

                        // set the interaction data to null
                        this.data = null;

                        this.zIndex = 0;

                        event.currentTarget.calculateBounds();
                        var points = check(event.currentTarget.children);
                        this.position.x = points.x - 3;
                        this.position.y = points.y - 3;
                    }

                    function onDragMove(event) {
                        if (this.dragging)
                        {
                            this.position.x += this.data.originalEvent.movementX;
                            this.position.y += this.data.originalEvent.movementY;
                            contain(event.currentTarget, {x : defaultIndentation, y : defaultIndentation, width : renderer.width, height: renderer.height});
                        }
                    }

                    function onClick(event)
                    {
                        unCheck(event.currentTarget.children);
                        // var rad = 90 * Math.PI / 180;
                        this.rotation += Math.PI / 2; 
                        // this.rotation += rad;
                    }

                    function check(children){
                        var points = new Array();
                        
                        for(var c = 0; c < children.length; c++){

                            var boundsChild = children[c]._bounds;

                            var xmin = boundsChild.minX;
                            var xmax = boundsChild.maxX;
                            var ymin = boundsChild.minY;
                            var ymax = boundsChild.maxY;
                            var centerX = xmin + 20;
                            var centerY = ymin + 20;
                            var countChildCheck = 0;
                            
                            for(var i = 0; i < matrixGrid.length; i++){
                                // console.log("BoundsGrid -> "+JSON.stringify(matrixGrid[i]));
                                if( matrixGrid[i].minX <= centerX && centerX <= matrixGrid[i].maxX && matrixGrid[i].minY <= centerY && centerY <= matrixGrid[i].maxY ) {
                                    matrixGrid[i].check = true;
                                    countChildCheck++;
                                    points.push({ x: matrixGrid[i].centerX, y: matrixGrid[i].centerY, minX:matrixGrid[i].minX, minY: matrixGrid[i].minY, maxX: matrixGrid[i].maxX, maxY: matrixGrid[i].maxY  });
                                }
                            }
                        }

                        // console.log("meio -> "+JSON.stringify(findCenter(points)));
                        countCheckGrid();
                        return findCenter(points);
                    }

                    function unCheck(children){
                        for(var c = 0; c < children.length; c++){
                            var boundsChild = children[c]._bounds;
                            // console.log("BoundsElement -> "+JSON.stringify(boundsChild));

                            var xmin = boundsChild.minX;
                            var xmax = boundsChild.maxX;
                            var ymin = boundsChild.minY;
                            var ymax = boundsChild.maxY;
                            var centerX = xmin + 20;
                            var centerY = ymin + 20;
                            
                            for(var i = 0; i < matrixGrid.length; i++){
                                // console.log("BoundsGrid -> "+JSON.stringify(matrixGrid[i]));
                                if( matrixGrid[i].minX <= centerX && centerX <= matrixGrid[i].maxX && matrixGrid[i].minY <= centerY && centerY <= matrixGrid[i].maxY ) {
                                    matrixGrid[i].check = false;
                                    // console.log("achou -> "+JSON.stringify(matrixGrid[i]));    
                                }
                            }
                        }
                    }

                    function countCheckGrid(){
                        
                        var count = 0;
                        var countFalse = 0;;

                        for(var i = 0; i < matrixGrid.length; i++){
                            if( matrixGrid[i].check == true ) {
                                count++;
                            }
                            else{
                                countFalse++;
                            }
                        }
                        document.getElementById("teste").innerHTML = ""+count+" Preenchido";
                        document.getElementById("teste1").innerHTML = ""+countFalse+" Vazio";
                    }

                    function findCenter(points) {

                        var x = 0, y = 0, i, len = points.length;
                        var arrayX = new Array();
                        var arrayY = new Array();

                        for (i = 0; i < len; i++) {

                            arrayX.push(points[i].minX);
                            arrayX.push(points[i].maxX);

                            arrayY.push(points[i].minY);
                            arrayY.push(points[i].maxY);

                            // x += points[i].x;
                            // y += points[i].y;
                        }

                        var yMin = Math.min.apply(Math, arrayY);
                        var yMax = Math.max.apply(Math, arrayY);

                        var xMin = Math.min.apply(Math, arrayX);
                        var xMax = Math.max.apply(Math, arrayX);

                        var yInterval = yMax - yMin;
                        var xInterval = xMax - xMin;

                        var newX = xMin + xInterval / 2;
                        var newY = yMin + yInterval / 2;

                        console.log("newX -> "+newX+" | newY -> "+newY);

                        // return {x: x / len, y: y / len};   // return average position
                        return {x: newX, y: newY};
                    }

                    // run the render loop
                    animate();

                    function animate()
                    {
                        renderer.render(stage);
                        requestAnimationFrame( animate );
                    }

                    window.addEventListener("resize", function(event){ 
                        scaleToWindow(renderer.view);
                    });

                   
                    function contain(sprite, container) 
                    {
                        
                        var collision = undefined;
                        sprite.calculateBounds(); 

                        var rotation = Math.ceil(sprite.rotation);
                        var bounds = sprite._bounds;
                        var yInterval = bounds.maxY - bounds.minY;
                        var xInterval = bounds.maxX - bounds.minX; 
                    
                        //Left
                        if (bounds.minX < 0.5) {
                            sprite.x = 0.5 + xInterval/2;
                            collision = "left";
                        }

                        //Top
                        if (bounds.minY < 0.5) {
                            sprite.y = 0.5 + yInterval/2;
                            collision = "top";
                        }

                        //Right
                        if (bounds.maxX > container.width) {
                            sprite.x = container.width - xInterval/2;
                            collision = "right";
                        }
                        //Bottom
                        if (bounds.maxY > container.height) {
                            sprite.y = container.height - yInterval/2;
                            collision = "bottom";
                        }

                        return collision;
                    }

            </script>
      <!-- </body> -->

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

</html>
