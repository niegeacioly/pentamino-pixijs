<!DOCTYPE html>
<html lang="pt-br">
    <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

      <!-- Bootstrap CSS -->
      <!-- integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" -->
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" crossorigin="anonymous">
      <link rel="stylesheet" href="gameplay.css">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.5.1/pixi.min.js"></script>
      <script src="../bin/scaleToWindow.js"></script>
      <title>Game Play</title>
      </head>
      <body>
          <nav class="navbar navbar-light bg-faded">
            <a class="navbar-brand" href="#">
              <img src="images/logo_pentamino.png" class="img-fluid" width="200" height="auto" class="d-inline-block align-top" alt="PentaminÃ³">
            </a>
            <br>
            <span id="teste">0</span>
            <br>
            <span id="teste1">0</span>
          </nav>    

          <script type="text/javascript">

                //Aliases
                    var Container = PIXI.Container,
                        autoDetectRenderer = PIXI.autoDetectRenderer,
                        loader = PIXI.loader,
                        resources = PIXI.loader.resources,
                        Sprite = PIXI.Sprite;

                    var stage = new Container(), renderer = autoDetectRenderer(1200, 600, { antialias: true }, true);
                    renderer.view.style.border = "1px dashed black";
                    renderer.backgroundColor = 0x232325;

                    var matrixGrid = new Array();

                    var minPixel = 3, defaultIndentation = 20;

                    const GRID_INDENTATION = 300, GRID_INDENTATION_Y = 40, GRID_WIDTH = 850, GRID_HEIGHT = 270, DEFAULT_SIZE_BLOCK = 40;

                    document.body.appendChild(renderer.view);

                    var gridHeight = 0;
                    var columnSelected = 0, rowSelected = 0;

                    loader
                        .add("images/grid.png")
                        .add("images/grid_6x10_normal.png")
                        .add("images/grid_5x12_normal.png")
                        .add("images/grid_4x15_normal.png")
                        .add("images/grid_3x20_normal.png")
                        .add("images/blockz.png")
                        .add("images/blocky.png")
                        .add("images/blockl.png")
                        .add("images/blocki.png")
                        .add("images/blockn.png")
                        .add("images/blockt.png")
                        .add("images/blockx.png")
                        .add("images/blockw.png")
                        .add("images/blockf.png")
                        .add("images/blockv.png")
                        .add("images/blocku.png")
                        .add("images/blockp.png")
                        .load(setupMiniGrids)
                        .load(setupGrid)
                        .load(setupLetterZ)
                        .load(setupLetterY)
                        .load(setupLetterL)
                        .load(setupLetterI)
                        .load(setupLetterN)
                        .load(setupLetterT)
                        .load(setupLetterX)
                        .load(setupLetterW)
                        .load(setupLetterF)
                        .load(setupLetterV)
                        .load(setupLetterU)
                        .load(setupLetterP);

                    function setupMiniGrids() {

                        //Create the grid
                        miniGridContainer = new Container();

                        resource = resources["images/grid_6x10_normal.png"].texture;
                        var grid1 = new Sprite(resource);
                        miniGridContainer.addChild(grid1);

                        resource = resources["images/grid_5x12_normal.png"].texture;
                        var grid2 = new Sprite(resource);
                        grid2.y = grid1.y + grid1.height + defaultIndentation;
                        miniGridContainer.addChild(grid2);

                        resource = resources["images/grid_4x15_normal.png"].texture;
                        var grid3 = new Sprite(resource);
                        grid3.y = grid2.y + grid2.height + defaultIndentation;
                        miniGridContainer.addChild(grid3);

                        resource = resources["images/grid_3x20_normal.png"].texture;
                        var grid4 = new Sprite(resource);
                        grid4.y = grid3.y + grid3.height + defaultIndentation;
                        miniGridContainer.addChild(grid4);

                        stage.addChild(miniGridContainer);

                    }


                    function setupGrid() {

                        //Create the grid
                        gridContainer = new Container();
                        resource = resources["images/grid.png"].texture;
                        var grid = new Sprite(resource);
                        gridContainer.addChild(grid);
                        stage.addChild(gridContainer);

                        gridContainer.x = GRID_INDENTATION;
                        gridContainer.y = GRID_INDENTATION_Y;


                        gridHeight = grid.height + defaultIndentation;

                        var row = 6, column = 10;

                        for(var y = 1; y <= row; y++) {
                            for(var x = 1; x <= column; x++) {
                                var maxX = 0, minX = 0, maxY = 0, minY = 0;
                                maxX = ((DEFAULT_SIZE_BLOCK * x) - (x * minPixel)) + (GRID_INDENTATION + minPixel);
                                maxY = ((DEFAULT_SIZE_BLOCK * y) - (y * minPixel)) + (GRID_INDENTATION_Y + minPixel);
                                minX = ((maxX - DEFAULT_SIZE_BLOCK) + minPixel)
                                minY = ((maxY - DEFAULT_SIZE_BLOCK) + minPixel)

                                matrixGrid.push(
                                    { minX: minX, minY: minY, maxX: maxX, maxY: maxY, centerX: minX + defaultIndentation, centerY: minY + defaultIndentation, check: false });
                            }
                        }

                        var bgWidth = DEFAULT_SIZE_BLOCK * column - (minPixel * (column - 1));
                        var bgHeight = DEFAULT_SIZE_BLOCK * row - (minPixel * (row - 1));

                        countCheckGrid();
                        drawBackgroundRectGrid(bgWidth,bgHeight );
                        drawBackgroundRectForLetters(gridHeight);
                    }

                    function drawBackgroundRectGrid(bgWidth,bgHeight) {
                        var graphics = new PIXI.Graphics();
                        graphics.beginFill(0xFDFDFF);
                        graphics.alpha = 0.1;
                        // draw a rectangle
                        graphics.drawRect(GRID_INDENTATION, GRID_INDENTATION_Y, bgWidth,bgHeight);
                        graphics.endFill();

                        stage.addChild(graphics);
                    }

                    function drawBackgroundRectForLetters(gridHeight) {
                        var graphics = new PIXI.Graphics();

                        graphics.beginFill(0xBCB09A);

                        // draw a rectangle
                        graphics.drawRect(GRID_INDENTATION, gridHeight, GRID_WIDTH, GRID_HEIGHT);
                        graphics.y = GRID_INDENTATION_Y;

                        stage.addChild(graphics);
                    }

                    function setupLetterZ() {

                        //Create the sprites
                        gameSceneZ = new Container();
                        gameSceneZ.interactive = true;
                        gameSceneZ.position.rotation = 0;
                        gameSceneZ.x = GRID_INDENTATION + defaultIndentation * 4;
                        gameSceneZ.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 4;
                        gameSceneZ.filter = { name: "Z", id: 1, x: gameSceneZ.x, y: gameSceneZ.y };
                        gameSceneZ.rotation = 0;
                        gameSceneZ.zIndex = 0;

                        resource = resources["images/blockz.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneZ.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneZ.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0;

                        gameSceneZ.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneZ.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2 );

                        gameSceneZ.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2 );
                        block5.position.x = block1.width + block2.width - (minPixel * 2 );

                        gameSceneZ.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneZ);
                        gameSceneZ.pivot.set(gameSceneZ.width/2, gameSceneZ.height/2);
                        gameSceneZ.updateTransform();
                    }

                    function setupLetterY() {

                        //Create the sprites
                        gameSceneY = new Container();
                        gameSceneY.interactive = true;
                        gameSceneY.position.rotation = 0;
                        gameSceneY.x = GRID_INDENTATION + defaultIndentation * 5;
                        gameSceneY.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 9;
                        gameSceneY.filter = { name: "Y", id: 2, x: gameSceneY.x, y: gameSceneY.y };
                        gameSceneY.rotation = 0;
                        gameSceneY.zIndex = 0;

                        resource = resources["images/blocky.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneY.addChild(block1);
                        block1.position.y = block1.height - minPixel;
                        block1.position.x = 0;

                        gameSceneY.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneY.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width - minPixel;

                        gameSceneY.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneY.addChild(block5);
                        block5.position.y = block1.height - minPixel;
                        block5.position.x = block1.width + block2.width + block3.width - (minPixel * 3);

                        gameSceneY.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneY);
                        gameSceneY.pivot.set(gameSceneY.width/2, gameSceneY.height/2);
                        gameSceneY.updateTransform();
                    }

                    function setupLetterL() {

                        //Create the sprites
                        gameSceneL = new Container();
                        gameSceneL.interactive = true;
                        gameSceneL.position.rotation = 0;
                        gameSceneL.x = GRID_INDENTATION + defaultIndentation * 10;
                        gameSceneL.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 5;
                        gameSceneL.filter = { name: "L", id: 3, x: gameSceneL.x, y: gameSceneL.y };
                        gameSceneL.rotation = 0;
                        gameSceneL.zIndex = 0;

                        resource = resources["images/blockl.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneL.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneL.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block4);
                        block4.position.y = block1.height + block2.height - (minPixel * 2);
                        block4.position.x = block1.width - minPixel;

                        gameSceneL.addChild(block5);
                        block5.position.y = block1.height + block2.height + block3.height - (minPixel * 3);
                        block5.position.x = block1.width - minPixel;

                        gameSceneL.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneL);
                        gameSceneL.pivot.set(gameSceneL.width/2, gameSceneL.height/2);
                        gameSceneL.updateTransform();
                    }
                    
                    function setupLetterI() {

                        //Create the sprites
                        gameSceneI = new Container();
                        gameSceneI.interactive = true;
                        gameSceneI.position.rotation = 0;
                        gameSceneI.x = GRID_INDENTATION + defaultIndentation * 18;
                        gameSceneI.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 2 + 5;
                        gameSceneI.filter = { name: "I", id: 4, x: gameSceneI.x, y: gameSceneI.y };
                        gameSceneI.rotation = 0;
                        gameSceneI.zIndex = 0;
                        
                        resource = resources["images/blocki.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneI.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneI.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneI.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneI.addChild(block4);
                        block4.position.y = 0;
                        block4.position.x = block1.width + block2.width + block3.width - (minPixel * 3);

                        gameSceneI.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width + block3.width + block4.width - (minPixel * 4);

                        gameSceneI.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneI);
                        gameSceneI.pivot.set(gameSceneI.width/2, gameSceneI.height/2);
                        gameSceneI.updateTransform();
                    }

                    function setupLetterN() {

                        //Create the sprites
                        gameSceneN = new Container();
                        gameSceneN.interactive = true;
                        gameSceneN.position.rotation = 0;
                        gameSceneN.x = GRID_INDENTATION + defaultIndentation * 14 + 5;
                        gameSceneN.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 7 + 10;
                        gameSceneN.filter = { name: "N", id: 5, x: gameSceneN.x, y: gameSceneN.y };
                        gameSceneN.rotation = 0;
                        gameSceneN.zIndex = 0;

                        resource = resources["images/blockn.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneN.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block3);
                        block3.position.y = block1.height + block2.height - (minPixel * 2);
                        block3.position.x = block1.width - minPixel;

                        gameSceneN.addChild(block4);
                        block4.position.y = block1.height + block2.height - (minPixel * 2);
                        block4.position.x = 0;

                        gameSceneN.addChild(block5);
                        block5.position.y = block1.height + block2.height + block3.height - (minPixel * 3);
                        block5.position.x = 0;

                        gameSceneN.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneN);
                        gameSceneN.pivot.set(gameSceneN.width/2, gameSceneN.height/2);
                        gameSceneN.updateTransform();
                    }
                    
                    function setupLetterT() {

                        //Create the sprites
                        gameSceneT = new Container();
                        gameSceneT.interactive = true;
                        gameSceneT.position.rotation = 0;
                        gameSceneT.x = GRID_INDENTATION + defaultIndentation * 20;
                        gameSceneT.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 8;
                        gameSceneT.filter = { name: "T", id: 6, x: gameSceneT.x, y: gameSceneT.y };
                        gameSceneT.rotation = 0;
                        gameSceneT.zIndex = 0;

                        resource = resources["images/blockt.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneT.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.height - minPixel;

                        gameSceneT.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneT.addChild(block3);
                        block3.position.y = (block1.height - minPixel) + (block2.height - minPixel);
                        block3.position.x = (block1.width - minPixel) + (block2.width - minPixel);

                        gameSceneT.addChild(block4);
                        block4.position.y = (block1.height - minPixel) + (block2.height - minPixel);
                        block4.position.x = (block1.height - minPixel);

                        gameSceneT.addChild(block5);
                        block5.position.y = (block1.height - minPixel) + (block1.height - minPixel);
                        block5.position.x = 0;

                        gameSceneT.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneT);
                        gameSceneT.pivot.set(gameSceneT.width/2, gameSceneT.height/2);
                        gameSceneT.updateTransform();
                    }

                    function setupLetterX() {

                        //Create the sprites
                        gameSceneX = new Container();
                        gameSceneX.interactive = true;
                        gameSceneX.position.rotation = 0;
                        gameSceneX.x = GRID_INDENTATION + defaultIndentation * 26;
                        gameSceneX.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 9;
                        gameSceneX.filter = { name: "X", id: 7, x: gameSceneX.x, y: gameSceneX.y };
                        gameSceneX.rotation = 0;
                        gameSceneX.zIndex = 0;

                        resource = resources["images/blockx.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneX.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = block1.width - minPixel;

                        gameSceneX.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0;

                        gameSceneX.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneX.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneX.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width - minPixel;

                        gameSceneX.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove);

                        stage.addChild(gameSceneX);
                        gameSceneX.pivot.set(gameSceneX.width/2, gameSceneX.height/2);
                        gameSceneX.updateTransform();
                    }

                    function setupLetterW() {

                        //Create the sprites
                        gameSceneW = new Container();
                        gameSceneW.interactive = true;
                        gameSceneW.position.rotation = 0;
                        gameSceneW.x = GRID_INDENTATION + defaultIndentation * 27;
                        gameSceneW.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 4;
                        gameSceneW.filter = { name: "W", id: 8, x: gameSceneW.x, y: gameSceneW.y };
                        gameSceneW.rotation = 0;
                        gameSceneW.zIndex = 0;
                        
                        resource = resources["images/blockw.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneW.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneW.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.width - minPixel;

                        gameSceneW.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneW.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneW.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneW.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick)
                            ;

                        stage.addChild(gameSceneW);
                        gameSceneW.pivot.set(gameSceneW.width/2, gameSceneW.height/2);
                        gameSceneW.updateTransform();
                    }
                    
                    function setupLetterF() {

                        //Create the sprites
                        gameSceneF = new Container();
                        gameSceneF.interactive = true;
                        gameSceneF.position.rotation = 0;
                        gameSceneF.x = GRID_INDENTATION + defaultIndentation * 33;
                        gameSceneF.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 4;
                        gameSceneF.filter = { name: "F", id: 9, x: gameSceneF.x, y: gameSceneF.y };
                        gameSceneF.rotation = 0;
                        gameSceneF.zIndex = 0;

                        resource = resources["images/blockf.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneF.addChild(block1);
                        block1.position.y = block1.height - minPixel;
                        block1.position.x = 0;

                        gameSceneF.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = block1.width - minPixel;

                        gameSceneF.addChild(block3);
                        block3.position.y = 0;
                        block3.position.x = block1.width - minPixel;

                        gameSceneF.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneF.addChild(block5);
                        block5.position.y = block1.height + block2.height - (minPixel * 2);
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneF.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        console.log("w -> "+gameSceneF.width + " | h -> "+gameSceneF.height);
                        gameSceneF.pivot.set(gameSceneF.width/2, gameSceneF.height/2);
                        stage.addChild(gameSceneF);
                        gameSceneF.updateTransform();
                    }

                    function setupLetterV() {

                        //Create the sprites
                        gameSceneV = new Container();
                        gameSceneV.interactive = true;
                        gameSceneV.position.rotation = 0;
                        gameSceneV.x = GRID_INDENTATION + defaultIndentation * 33;
                        gameSceneV.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 10;
                        gameSceneV.filter = { name: "V", id: 10, x: gameSceneV.x, y: gameSceneV.y };
                        gameSceneV.rotation = 0;
                        gameSceneV.zIndex = 0;

                        resource = resources["images/blockv.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneV.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneV.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0 ;

                        gameSceneV.addChild(block3);
                        block3.position.y = block1.height + block2.height - (minPixel * 2);
                        block3.position.x = 0;

                        gameSceneV.addChild(block4);
                        block4.position.y = 0;
                        block4.position.x = block1.width - minPixel;

                        gameSceneV.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneV.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneV);
                        gameSceneV.pivot.set(gameSceneV.width/2, gameSceneV.height/2);
                        gameSceneV.updateTransform();
                    }

                    function setupLetterU() {

                        //Create the sprites
                        gameSceneU = new Container();
                        gameSceneU.interactive = true;
                        gameSceneU.position.rotation = 0;
                        gameSceneU.x = GRID_INDENTATION + defaultIndentation * 39;
                        gameSceneU.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 3;
                        gameSceneU.filter = { name: "U", id: 11, x: gameSceneU.x, y: gameSceneU.y };
                        gameSceneU.rotation = 0;
                        gameSceneU.zIndex = 0;

                        resource = resources["images/blocku.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneU.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneU.addChild(block2);
                        block2.position.y = block1.height - minPixel;
                        block2.position.x = 0 ;

                        gameSceneU.addChild(block3);
                        block3.position.y = block1.height - minPixel;
                        block3.position.x = block1.width - minPixel;

                        gameSceneU.addChild(block4);
                        block4.position.y = block1.height - minPixel;
                        block4.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneU.addChild(block5);
                        block5.position.y = 0;
                        block5.position.x = block1.width + block2.width - (minPixel * 2);

                        gameSceneU.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);

                        stage.addChild(gameSceneU);
                        gameSceneU.pivot.set(gameSceneU.width/2, gameSceneU.height/2);
                        gameSceneU.updateTransform();
                    }

                    function setupLetterP() {

                        //Create the sprites
                        gameSceneP = new Container();
                        gameSceneP.interactive = true;
                        gameSceneP.x = GRID_INDENTATION + defaultIndentation * 39;
                        gameSceneP.y = gridHeight + GRID_INDENTATION_Y + defaultIndentation * 9;
                        gameSceneP.filter = { name: "P", id: 12, x: gameSceneP.x, y: gameSceneP.y };
                        gameSceneP.rotation = 0;
                        gameSceneP.zIndex = 0;

                        resource = resources["images/blockp.png"].texture;
                        var block1 = new Sprite(resource);
                        var block2 = new Sprite(resource);
                        var block3 = new Sprite(resource);
                        var block4 = new Sprite(resource);
                        var block5 = new Sprite(resource);

                        gameSceneP.addChild(block1);
                        block1.position.y = 0;
                        block1.position.x = 0;

                        gameSceneP.addChild(block2);
                        block2.position.y = 0;
                        block2.position.x = block1.height - minPixel;

                        gameSceneP.addChild(block3);
                        block3.position.y = block2.height - minPixel;
                        block3.position.x = 0;

                        gameSceneP.addChild(block4);
                        block4.position.y = block3.height - minPixel;
                        block4.position.x = block3.width - minPixel;

                        gameSceneP.addChild(block5);
                        block5.position.y = (block4.height - minPixel) + (block4.height - minPixel);
                        block5.position.x = 0;

                        // setup events
                        gameSceneP.on('mousedown', onDragStart)
                            .on('touchstart', onDragStart)
                            .on('mouseup', onDragEnd)
                            .on('mouseupoutside', onDragEnd)
                            .on('touchend', onDragEnd)
                            .on('touchendoutside', onDragEnd)
                            .on('mousemove', onDragMove)
                            .on('touchmove', onDragMove)
                            .on('click', onClick);
                        
                        stage.addChild(gameSceneP);

                        gameSceneP.pivot.set(gameSceneP.width/2, gameSceneP.height/2);
                        gameSceneP.updateTransform();

                    }

                    function onDragStart(event) {
                        // store a reference to the data the reason for this is because of multitouch we want to track the movement of this particular touch
                        this.start_data = {x: event.data.originalEvent.screenX, y: event.data.originalEvent.screenY};
                        this.data = event.data;
                        this.alpha = 0.5;
                        this.dragging = true;
                        this.zIndex = 999;

                        event.currentTarget.calculateBounds();
                        unCheck(event.currentTarget.children);
                        
                    }   

                    function onDragEnd(event) {

                        var ev_data = event.data.originalEvent;

                        this.alpha = 1;

                        this.dragging = false;

                        if (this.start_data) {
                            if (Math.abs(this.start_data.x - ev_data.screenX) > 2 || Math.abs(this.start_data.y - ev_data.screenY) > 2) {
                                event.stopPropagation();
                            }
                        }

                        // set the interaction data to null
                        this.data = null;

                        this.zIndex = 0;

                        event.currentTarget.calculateBounds();
                        var points = check(event.currentTarget.children);

                        if(points.x == 0){
                            this.position.x = this.filter.x;
                            this.position.y = this.filter.y;
                            this.rotation = 0;
                        }
                        else{
                            this.position.x = points.x;
                            this.position.y = points.y;
                        }
                    }

                    function onDragMove(event) {
                        if (this.dragging)
                        {
                            this.position.x += this.data.originalEvent.movementX;
                            this.position.y += this.data.originalEvent.movementY;
                            contain(event.currentTarget, {x : defaultIndentation, y : defaultIndentation, width : renderer.width, height: renderer.height});
                        }
                    }

                    function onClick(event)
                    {
                        unCheck(event.currentTarget.children);
                        this.rotation += Math.PI / 2; 
                    }

                    function check(children){
                        var points = new Array();
                        
                        for(var c = 0; c < children.length; c++){

                            var boundsChild = children[c]._bounds;
                            
                            var xmin = boundsChild.minX;
                            var xmax = boundsChild.maxX;
                            var ymin = boundsChild.minY;
                            var ymax = boundsChild.maxY;
                            var centerX = xmin + defaultIndentation;
                            var centerY = ymin + defaultIndentation;
                            var countChildCheck = 0;
                            
                            for(var i = 0; i < matrixGrid.length; i++){
                                if( matrixGrid[i].minX <= centerX && centerX <= matrixGrid[i].maxX && matrixGrid[i].minY <= centerY && centerY <= matrixGrid[i].maxY ) {
                                    matrixGrid[i].check = true;
                                    countChildCheck++;
                                    points.push({ x: matrixGrid[i].centerX, y: matrixGrid[i].centerY, minX:matrixGrid[i].minX, minY: matrixGrid[i].minY, maxX: matrixGrid[i].maxX, maxY: matrixGrid[i].maxY  });
                                }
                            }
                        }

                        countCheckGrid();
                        if(points.length == 5){
                            return findCenter(points);
                        }  
                        else{
                            return {x: 0, y: 0};
                        }
                        
                    }

                    function unCheck(children){
                        for(var c = 0; c < children.length; c++){
                            var boundsChild = children[c]._bounds;
                            // console.log("BoundsElement -> "+JSON.stringify(boundsChild));

                            var xmin = boundsChild.minX;
                            var xmax = boundsChild.maxX;
                            var ymin = boundsChild.minY;
                            var ymax = boundsChild.maxY;
                            var centerX = xmin + defaultIndentation;
                            var centerY = ymin + defaultIndentation;
                            
                            for(var i = 0; i < matrixGrid.length; i++){
                                // console.log("BoundsGrid -> "+JSON.stringify(matrixGrid[i]));
                                if( matrixGrid[i].minX <= centerX && centerX <= matrixGrid[i].maxX && matrixGrid[i].minY <= centerY && centerY <= matrixGrid[i].maxY ) {
                                    matrixGrid[i].check = false;
                                    // console.log("achou -> "+JSON.stringify(matrixGrid[i]));    
                                }
                            }
                        }
                    }

                    function countCheckGrid(){
                        
                        var count = 0;
                        var countFalse = 0;;

                        for(var i = 0; i < matrixGrid.length; i++){
                            if( matrixGrid[i].check == true ) {
                                count++;
                            }
                            else{
                                countFalse++;
                            }
                        }
                        document.getElementById("teste").innerHTML = ""+count+" Preenchido";
                        document.getElementById("teste1").innerHTML = ""+countFalse+" Vazio";
                    }

                    function findCenter(points) {

                        var len = points.length;
                        var arrayX = new Array();
                        var arrayY = new Array();

                        for (i = 0; i < len; i++) {
                            arrayX.push(points[i].minX);
                            arrayX.push(points[i].maxX);
                            arrayY.push(points[i].minY);
                            arrayY.push(points[i].maxY);
                        }

                        var yMin = Math.min.apply(Math, arrayY);
                        var yMax = Math.max.apply(Math, arrayY);

                        var xMin = Math.min.apply(Math, arrayX);
                        var xMax = Math.max.apply(Math, arrayX);

                        var yInterval = yMax - yMin;
                        var xInterval = xMax - xMin;

                        var newX = (xMin + xInterval / 2);
                        var newY = (yMin + yInterval / 2);

                        console.log("newX -> "+newX+" | newY -> "+newY);

                        return { x: newX, y: newY };
                    }

                    // run the render loop
                    animate();

                    function animate()
                    {
                        renderer.render(stage);
                        requestAnimationFrame( animate );
                    }

                    window.addEventListener("resize", function(event){ 
                        scaleToWindow(renderer.view);
                    });

                   
                    function contain(sprite, container) 
                    {
                        
                        var collision = undefined;
                        sprite.calculateBounds(); 

                        var rotation = Math.ceil(sprite.rotation);
                        var bounds = sprite._bounds;
                        var yInterval = bounds.maxY - bounds.minY;
                        var xInterval = bounds.maxX - bounds.minX; 
                    
                        //Left
                        if (bounds.minX < 0.5) {
                            sprite.x = 0.5 + xInterval/2;
                            collision = "left";
                        }

                        //Top
                        if (bounds.minY < 0.5) {
                            sprite.y = 0.5 + yInterval/2;
                            collision = "top";
                        }

                        //Right
                        if (bounds.maxX > container.width) {
                            sprite.x = container.width - xInterval/2;
                            collision = "right";
                        }
                        //Bottom
                        if (bounds.maxY > container.height) {
                            sprite.y = container.height - yInterval/2;
                            collision = "bottom";
                        }

                        return collision;
                    }

            </script>
      <!-- </body> -->

    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

</html>
